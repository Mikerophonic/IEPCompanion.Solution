@using IEPCompanion.Models;
@using IEPCompanion.ViewModels
@model LoginViewModel

<h1>IEP Home</h1>
<hr />
<div>
  @if(!User.Identity.IsAuthenticated)
  {
    <h2>Log in with your account</h2>
    <hr />

    @if(!ViewData.ModelState.IsValid) 
    {
      @Html.ValidationSummary("Please fix the following error(s) and then resubmit the form:") 
    }

    @using (Html.BeginForm("Login", "Accounts", FormMethod.Post))
    {
      @Html.LabelFor(m => m.Email)
      @Html.TextBoxFor(m => m.Email)

      @Html.LabelFor(m => m.Password)
      @Html.EditorFor(m => m.Password)

      <input type="submit" value="Log in" />
    }
  }
</div>
else {

  <h4>IEP Listing</h4>
  @if (Model["ieps"].Count == 0)
  {
    <p>No Individual Education Plans have been added yet!</p>
  }
  else
  {
    <ul>
      @foreach (IEP iep in Model["ieps"])
      {
        <li>@Html.ActionLink($"{iep.IEPId}", "Details", "Home" , new { id = iep.IEPId })</li>
      }
    </ul>
    }

  <h4>People Listing</h4>
  @if (Model["people"].Count == 0)
  {
    <p>No People added</p>
  }
  else
  {
    <h4>Teachers</h4>
    <ul>
      @foreach (Person person in Model["people"])
      {
        @if (person.Category == "Teacher")
        {
          <li>@Html.ActionLink($"ID: {person.PersonId} {person.LastName}, {person.FirstName}", "Details", "Peoples" , new { id = person.PersonId })</li>
        }
      }
      @Html.ActionLink("",)
    </ul>
    <br>
    <h4>Students</h4>
    <ul>
      @foreach (Person person in Model["people"])
      {
        @if (person.Category == "Student")
        {
          <li>@Html.ActionLink($"ID: {person.PersonId} {person.LastName}, {person.FirstName}", "Details", "Peoples" , new { id = person.PersonId })</li>
        }
      }
    </ul>
    <br>
    <h4>Parents</h4>
    <ul>
      @foreach (Person person in Model["people"])
      {
        @if (person.Category == "Parent")
        {
          <li>@Html.ActionLink($"ID: {person.PersonId} {person.LastName}, {person.FirstName}", "Details", "Peoples" , new { id = person.PersonId })</li>
        }
      }
    </ul>
    <br>
    <h4>Administrators</h4>
    <ul>
      @foreach (Person person in Model["people"])
      {
        @if (person.Category == "Administrator")
        {
          <li>@Html.ActionLink($"ID: {person.PersonId} {person.LastName}, {person.FirstName}", "Details", "Peoples" , new { id = person.PersonId })</li>
        }
      }
    </ul>
  }
}